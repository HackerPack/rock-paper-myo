<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>rock-paper-myo</title>


    <link href='https://fonts.googleapis.com/css?family=Lato:400,700' rel='stylesheet' type='text/css'>
    <!-- Bootstrap Core CSS -->
    <link href="../bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- MetisMenu CSS -->
    <link href="../bower_components/metisMenu/dist/metisMenu.min.css" rel="stylesheet">

    <!-- Timeline CSS -->
    <link href="../dist/css/timeline.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="../dist/css/sb-admin-2.css" rel="stylesheet">

    <!-- Morris Charts CSS -->
    <link href="../bower_components/morrisjs/morris.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="../bower_components/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <style>
      /* NOTE: The styles were added inline because Prefixfree needs access to your styles and they must be inlined if they are on local disk! */
      * {
  box-sizing: border-box;
}

body {
  font-family: 'Lato', sans-serif;
  color: #202020;
}

p {
  display: none;
}

table {
  width: 100%;
  border-collapse: collapse;
  text-align: left;
  overflow: hidden;
}
table td, table th {
  border-top: 1px solid #ECF0F1;
  padding: 10px;
}
table td {
  border-left: 1px solid #ECF0F1;
  border-right: 1px solid #ECF0F1;
}
table th {
  background-color: #4ECDC4;
}
table tr:nth-of-type(even) td {
  background-color: #d9f4f2;
}
table .total th {
  background-color: white;
}
table .total td {
  text-align: right;
  font-weight: 700;
}

.mobile-header {
  display: none;
}

@media only screen and (max-width: 760px) {
  p {
    display: block;
    font-weight: bold;
  }

  table tr td:not(:first-child), table tr th:not(:first-child), table tr td:not(.total-val) {
    display: none;
  }
  table tr:nth-of-type(even) td:first-child {
    background-color: #d9f4f2;
  }
  table tr:nth-of-type(odd) td:first-child {
    background-color: white;
  }
  table tr:nth-of-type(even) td:not(:first-child) {
    background-color: white;
  }
  table tr th:first-child {
    width: 100%;
    display: block;
  }
  table tr th:not(:first-child) {
    width: 40%;
    transition: transform 0.4s ease-out;
    transform: translateY(-9999px);
    position: relative;
    z-index: -1;
  }
  table tr td:not(:first-child) {
    transition: transform 0.4s ease-out;
    transform: translateY(-9999px);
    width: 60%;
    position: relative;
    z-index: -1;
  }
  table tr td:first-child {
    display: block;
    cursor: pointer;
  }
  table tr.total th {
    width: 25%;
    display: inline-block;
  }
  table tr td.total-val {
    display: inline-block;
    transform: translateY(0);
    width: 75%;
  }
}
@media only screen and (max-width: 300px) {
  table tr th:not(:first-child) {
    width: 50%;
    font-size: 14px;
  }
  table tr td:not(:first-child) {
    width: 50%;
    font-size: 14px;
  }
}

    </style>

    
</head>

<body>

    <div id="wrapper">

        <!-- Navigation -->
        <nav class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="index`.html">Rescue Rangers</a>
            </div>
            <!-- /.navbar-header -->

            <ul class="nav navbar-top-links navbar-right">
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                        <i class="fa fa-envelope fa-fw"></i>  <i class="fa fa-caret-down"></i>
                    </a>
                    <ul class="dropdown-menu dropdown-messages">
                        <li>
                            <a href="#">
                                <div>
                                    <strong>John Smith</strong>
                                    <span class="pull-right text-muted">
                                        <em>Yesterday</em>
                                    </span>
                                </div>
                                <div>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque eleifend...</div>
                            </a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="#">
                                <div>
                                    <strong>John Smith</strong>
                                    <span class="pull-right text-muted">
                                        <em>Yesterday</em>
                                    </span>
                                </div>
                                <div>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque eleifend...</div>
                            </a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="#">
                                <div>
                                    <strong>John Smith</strong>
                                    <span class="pull-right text-muted">
                                        <em>Yesterday</em>
                                    </span>
                                </div>
                                <div>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque eleifend...</div>
                            </a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a class="text-center" href="#">
                                <strong>Read All Messages</strong>
                                <i class="fa fa-angle-right"></i>
                            </a>
                        </li>
                    </ul>
                    <!-- /.dropdown-messages -->
                </li>
                <!-- /.dropdown -->
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                        <i class="fa fa-tasks fa-fw"></i>  <i class="fa fa-caret-down"></i>
                    </a>
                    <ul class="dropdown-menu dropdown-tasks">
                        <li>
                            <a href="#">
                                <div>
                                    <p>
                                        <strong>Task 1</strong>
                                        <span class="pull-right text-muted">40% Complete</span>
                                    </p>
                                    <div class="progress progress-striped active">
                                        <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" style="width: 40%">
                                            <span class="sr-only">40% Complete (success)</span>
                                        </div>
                                    </div>
                                </div>
                            </a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="#">
                                <div>
                                    <p>
                                        <strong>Task 2</strong>
                                        <span class="pull-right text-muted">20% Complete</span>
                                    </p>
                                    <div class="progress progress-striped active">
                                        <div class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100" style="width: 20%">
                                            <span class="sr-only">20% Complete</span>
                                        </div>
                                    </div>
                                </div>
                            </a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="#">
                                <div>
                                    <p>
                                        <strong>Task 3</strong>
                                        <span class="pull-right text-muted">60% Complete</span>
                                    </p>
                                    <div class="progress progress-striped active">
                                        <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 60%">
                                            <span class="sr-only">60% Complete (warning)</span>
                                        </div>
                                    </div>
                                </div>
                            </a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="#">
                                <div>
                                    <p>
                                        <strong>Task 4</strong>
                                        <span class="pull-right text-muted">80% Complete</span>
                                    </p>
                                    <div class="progress progress-striped active">
                                        <div class="progress-bar progress-bar-danger" role="progressbar" aria-valuenow="80" aria-valuemin="0" aria-valuemax="100" style="width: 80%">
                                            <span class="sr-only">80% Complete (danger)</span>
                                        </div>
                                    </div>
                                </div>
                            </a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a class="text-center" href="#">
                                <strong>See All Tasks</strong>
                                <i class="fa fa-angle-right"></i>
                            </a>
                        </li>
                    </ul>
                    <!-- /.dropdown-tasks -->
                </li>
                <!-- /.dropdown -->
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                        <i class="fa fa-bell fa-fw"></i>  <i class="fa fa-caret-down"></i>
                    </a>
                    <ul class="dropdown-menu dropdown-alerts">
                        <li>
                            <a href="#">
                                <div>
                                    <i class="fa fa-comment fa-fw"></i> New Comment
                                    <span class="pull-right text-muted small">4 minutes ago</span>
                                </div>
                            </a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="#">
                                <div>
                                    <i class="fa fa-twitter fa-fw"></i> 3 New Followers
                                    <span class="pull-right text-muted small">12 minutes ago</span>
                                </div>
                            </a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="#">
                                <div>
                                    <i class="fa fa-envelope fa-fw"></i> Message Sent
                                    <span class="pull-right text-muted small">4 minutes ago</span>
                                </div>
                            </a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="#">
                                <div>
                                    <i class="fa fa-tasks fa-fw"></i> New Task
                                    <span class="pull-right text-muted small">4 minutes ago</span>
                                </div>
                            </a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="#">
                                <div>
                                    <i class="fa fa-upload fa-fw"></i> Server Rebooted
                                    <span class="pull-right text-muted small">4 minutes ago</span>
                                </div>
                            </a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a class="text-center" href="#">
                                <strong>See All Alerts</strong>
                                <i class="fa fa-angle-right"></i>
                            </a>
                        </li>
                    </ul>
                    <!-- /.dropdown-alerts -->
                </li>
                <!-- /.dropdown -->
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                        <i class="fa fa-user fa-fw"></i>  <i class="fa fa-caret-down"></i>
                    </a>
                    <ul class="dropdown-menu dropdown-user">
                        <li><a href="#"><i class="fa fa-user fa-fw"></i> User Profile</a>
                        </li>
                        <li><a href="#"><i class="fa fa-gear fa-fw"></i> Settings</a>
                        </li>
                        <li class="divider"></li>
                        <li><a href="login.html"><i class="fa fa-sign-out fa-fw"></i> Logout</a>
                        </li>
                    </ul>
                    <!-- /.dropdown-user -->
                </li>
                <!-- /.dropdown -->
            </ul>
            <!-- /.navbar-top-links -->

            <div class="navbar-default sidebar" role="navigation">
                <div class="sidebar-nav navbar-collapse">
                    <img src="../img/helping-hand1.jpeg" class ="sidebar-nav" height="700" width="250"/>
                </div>
                <!-- /.sidebar-collapse -->
            </div>
            <!-- /.navbar-static-side -->
        </nav>

        <div id="page-wrapper">
            <div class="row">
                <div class="col-lg-12">
                    <h1 class="page-header"><div id="disasterName">Dashboard</div></h1>
                </div>
                <!-- /.col-lg-12 -->
            </div>
            <!-- /.row -->
            <div class="row">
                <div class="col-lg-3 col-md-6">
                    <div class="panel panel-primary">
                        <div class="panel-heading">
                            <div class="row">
                                <div class="col-xs-3">
                                </div>
                                <div class="col-xs-9 text-right">
                                    <div id="pendingTasks"></div>
                                    <div>Pending Tasks</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="panel panel-green">
                        <div class="panel-heading">
                            <div class="row">
                                <div class="col-xs-3">
                                </div>
                                <div class="col-xs-9 text-right">
                                    <div id="completedTasks"></div>
                                    <div>Completed Tasks</div>
                                </div>
                            </div>
                        </div>                   
                         </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="panel panel-green">
                        <div class="panel-heading">
                            <div class="row">
                                <div class="col-xs-3">
                                </div>
                                <div class="col-xs-9 text-right">
                                    <div id="overdueTasks"></div>
                                    <div>Overdue Tasks</div>
                                </div>
                            </div>
                        </div>                   
                         </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="panel panel-green">
                        <div class="panel-heading">
                            <div class="row">
                                <div class="col-xs-3">
                                </div>
                                <div class="col-xs-9 text-right">
                                    <div id="trustLevel"></div>
                                    <div>Trust Level</div>
                                    <div></div>
                                </div>
                            </div>
                        </div>                   
                         </div>
                </div>
            </div>
            <!-- /.row -->
            <!-- Modal -->
            <div class="modal fade" id="myModal" role="dialog">
              <div class="modal-dialog">
              
                <!-- Modal content-->
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Thank you for volunteering</h4>
                  </div>
                  <div class="modal-body">
                    <p>Are you sure you would like to proceed with this task?</p>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-default" onclick="octaketask()">Agree</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                  </div>
                </div>
                
              </div>
            </div>
            <div class="modal fade" id="progressModal" role="dialog">
              <div class="modal-dialog">
              
                <!-- Modal content-->
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Thank you for volunteering</h4>
                  </div>
                  <div class="modal-body">
                    <p>Are there any changes to the task's progress?</p>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-default" onclick="occompletetask()">Completed</button>
                    <button type="button" class="btn btn-default" onclick="ocuntaketask()">Withdraw from task</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                  </div>
                </div>
                
              </div>
            </div>
            <div class="row">
                <div class="col-lg-8">
                        <!-- /.panel-heading -->
                        <div class="panel-body">
                            <div class="input-group col-md-12">
                                <input type="text" class="form-control input-lg" placeholder="Search" id="searchKeywords"/>
                                <span class="input-group-btn">
                                    <button class="btn btn-info btn-lg" type="button" onclick="searchTasks()">
                                        <i class="glyphicon glyphicon-search"></i>
                                    </button>
                                 </span>
                            </div>
                            <div class="dataTable_wrapper">
                            <h3>Tasks not assigned</h3>
                                <table class="table table-striped table-bordered table-hover" id="dataTables-example">
                                    <thead>
                                        <tr class ="table-headers">
                                            <!--<th>Choose</th> -->
                                            
                                            <th>Task Type</th>
                                            <th>Sent From Location</th>
                                            <th>Original Tweet</th>
                                            <th>Time of Tweet</th>
                                        </tr>
                                    </thead>
                                    <tbody id = "row12">
                                    </tbody>
                                </table>
                                    <h3>Tasks pending</h3>
                                <table class="table table-striped table-bordered table-hover" id="dataTables-example">
                                    <thead>
                                        <tr class = "table-headers">
                                            
                                            <th>Task Type</th>
                                            <th>Sent From Location</th>
                                            <th>Original Tweet</th>
                                            <th>Time of Tweet</th>
                                            <th>Task Overdue</th>
                                        </tr>
                                    </thead>
                                    <tbody id = "row13">
                                    </tbody>
                                </table>
                                    <h3>Tasks Completed</h3>
                                <table class="table table-striped table-bordered table-hover" id="dataTables-example">
                                    <thead>
                                        <tr class = "table-headers">
                                            
                                            <th>Task Type</th>
                                            <th>Sent From Location</th>
                                            <th>Original Tweet</th>
                                            <th>Time of Tweet</th>
                                            <th>Task Overdue</th>
                                        </tr>
                                    </thead>
                                    <tbody id = "row14">
                                    </tbody>
                                </table>
                                <!--<input type="button" value="Agree?" onclick="console.log($(this))" id="agreebutton" > -->
                                <!-- style="display: none;" -->
                            </div>
                        <div id="morris-area-chart"></div>
                        <!--</div>  -->
                        <!-- /.panel-body -->
                    </div> 
                    <!-- /.panel -->
                    <!-- /.panel -->
                </div>
                <!-- /.col-lg-8 -->
                <div class="col-lg-4" id ="sidebar">
                    <!-- /.panel -->
                    
                    <!-- /.panel -->

                    <!-- /.panel .chat-panel -->
                </div>
                <!-- /.col-lg-4 -->
            </div>
            <!-- /.row -->
        </div>
        <!-- /#page-wrapper -->

    </div>
    <!-- /#wrapper -->
<!-- <a class="twitter-timeline"  href="https://twitter.com/hashtag/ChennaiFloods" data-widget-id="693456602918227968">#ChennaiFloods Tweets</a>  -->
<!--<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
-->

<!-- <a class="twitter-timeline"  href="https://twitter.com/hashtag/snowstorm" data-widget-id="693457238711799808">#snowstorm Tweets</a>  -->
            <!--<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
        -->
<!--             <a class="twitter-timeline"  href="https://twitter.com/hashtag/ParisAttacks" data-widget-id="693458052176072704">#ParisAttacks Tweets</a>  -->
            <!--<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
        -->
<!--             <a class="twitter-timeline"  href="https://twitter.com/hashtag/AusOpen" data-widget-id="693472763428913153">#AusOpen Tweets</a>  -->
<!--            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>                    
-->            
          
    <!-- jQuery -->
    <script src="../bower_components/jquery/dist/jquery.min.js"></script>

          
    <!-- Bootstrap Core JavaScript -->
    <script src="../bower_components/bootstrap/dist/js/bootstrap.min.js"></script>

    <!-- Metis Menu Plugin JavaScript -->
    <script src="../bower_components/metisMenu/dist/metisMenu.min.js"></script>

    <!-- Morris Charts JavaScript -->
    <script src="../bower_components/raphael/raphael-min.js"></script>
    <script src="../bower_components/morrisjs/morris.min.js"></script>

    <!-- Custom Theme JavaScript -->
    <script src="../dist/js/sb-admin-2.js"></script>
    <script src="https://cdn.firebase.com/js/client/2.3.1/firebase.js"></script>
   <script src="../js/fire_base_constants.js"></script>
   <script src="../js/login.js"></script>
    <script src="../js/database.js"></script>
    <script></script>
    <script>
     var currentid;
     var disaster = window.location.search.substring(1).toLowerCase();
     
    function octaketask(){
        console.log("Inside octaketask");
        /*getId(function(uid){
            console.log("UID: "+uid);
            console.log("CurrentID: "+currentid);
        });*/
        var uid = getId(function(data){});
        takeTask(uid, currentid, function(){
            console.log("takeTask from octaketask");
            var address = "index1.html?" +disaster;
            console.log(address);
            window.location.href = address;
        });
    }
    function occompletetask(){
        console.log("Inside occompletetask");
        /*getId(function(uid){
            console.log("UID: "+uid);
            console.log("CurrentID: "+currentid);
        });*/
        var uid = getId(function(data){});
        completeTask(uid, currentid, function(){
            console.log("takeTask from octaketask");
            var address = "index1.html?" +disaster;
            console.log(address);
            window.location.href = address;
        });
    }
    function ocuntaketask(){
        console.log("Inside ocuntaketask");
        /*getId(function(uid){
            console.log("UID: "+uid);
            console.log("CurrentID: "+currentid);
        });*/
        var uid = getId(function(data){});
        untakeTask(uid, currentid, function(){
            console.log("takeTask from octaketask");
            var address = "index1.html?" +disaster;
            console.log(address);
            window.location.href = address;
        });
    }
   function searchTasks()
{
  var keyword = document.getElementById("searchKeywords").value;
  searchTask(disaster, keyword, function(array){
            console.log("Got list");
            $('#unassigned').append(disaster);
            $("#row12").append('<form>')
            for(var i =0;i<(array.length);i++)
            {
                $("#row12").empty();
                console.log(array[i].key());
                var currentTime = new Date(Date.now());
                    var hours = Math.abs(currentTime - array[i].val().TimeOfTweet) / 3600000;
                    if(hours > 24){
                        var Overdue = "Yes"

                    }else{
                        var Overdue = "No"
                    }
                $("#row12").append('<tr i align=center><td class=taskId style="display: none;">'+array[i].key()+'</td><td>'+array[i].val().TaskType+'</td><td>'+array[i].val().Location+'</td><td>'+array[i].val().OriginalTweet+'</td><td>'+array[i].val().TimeOfTweet+'</td><td>'+Overdue+'</td></tr>')
                };
            
        });


}

   function searchTasks()
{
  var keyword = document.getElementById("searchKeywords").value;
  searchTask(disaster, keyword, function(array){
            console.log("Got list");

            $("#row12").empty();
            $("#row12").append('<form>')
            for(var i =0;i<(array.length);i++)
            {
                console.log(array[i].key());
                var currentTime = new Date(Date.now());
                var tweetTime = new Date(array[i].val().TimeOfTweet);
                    var hours = Math.abs(currentTime -tweetTime ) / 3600000;
                    console.log("hours");
                    console.log(hours);
                    
                    if(hours > 24){
                        var Overdue = "Yes"
                        console.log(" I am in if");

                    }else{
                        console.log(" I am in else");
                        var Overdue = "No"
                    }
                $("#row12").append('<tr i align=center><td class=taskId style="display: none;">'+array[i].key()+'</td><td>'+array[i].val().TaskType+'</td><td>'+array[i].val().Location+'</td><td>'+array[i].val().OriginalTweet+'</td><td>'+array[i].val().TimeOfTweet+'</td></tr>');
                };
                $('#row12').children('tr').click(function(){
                console.log(this);
                $("#myModal").modal('show');
                currentid = $(this).find('.taskId').text();
                console.log("Current ID: "+currentid);

            });
            
        });


}
getMyTasks("315182856", function(data){

    console.log(data);
});

    $(document).ready(function(){
        $("#disasterName").html('#'+disaster);
        var pendingTasks = 0;
        var completedTasks = 0;
        var overdueTasks = 0;
        allTasks(disaster,function(array){
            console.log("Got list");
            $("#row12").append('<form>')
            for(var i =0;i<(array.length);i++)
            {
                console.log(array[i].key());
                var currentTime = new Date(Date.now());
                var tweetTime = new Date(array[i].val().TimeOfTweet);
                var hours = Math.abs(currentTime -tweetTime ) / 3600000;
                    
                    if(hours > 24){
                        var Overdue = "Yes";
                        overdueTasks++;

                    }else{
                        var Overdue = "No"
                    }
                $("#row12").append('<tr i align=center><td class=taskId style="display: none;">'+array[i].key()+'</td><td>'+array[i].val().TaskType+'</td><td>'+array[i].val().Location+'</td><td>'+array[i].val().OriginalTweet+'</td><td>'+array[i].val().TimeOfTweet+'</td></tr>')
            };
            $("#row12").append('</form>');

            $('#row12').children('tr').click(function(){
                console.log(this);
                $("#myModal").modal('show');
                currentid = $(this).find('.taskId').text();
                console.log("Current ID: "+currentid);

            });
        });
        getTwitterWidget(disaster,function(data){
        console.log(data[0]["hashtag"]);
        console.log(data[0]["twitterwidget"]);
        console.log(data[0]["link"]);
        //console.log(data[0][link]);
        //console.log(data[0][twitterwidget]);
        console.log("from getTwitterWidget");
        $("#sidebar").append('<a class="twitter-timeline"  href='+data[0]["link"]+' data-widget-id="'+data[0]["twitterwidget"]+'">#'+data[0]["hashtag"]+' Tweets</a>');
        !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
     });
        console.log('Entering');
            uid = getId(function(array){});
                console.log("This val" +uid);
             getMyTasks(uid, function(array){
                console.log("Printing data object");
                console.log(array);
                console.log("Got my Tasks");
                for(var i =0;i<(array.length);i++)
                {
                    pendingTasks++;
                    if(array[i].val().Overdue == "No")
                    {
                    var currentTime = new Date(Date.now());
                    console.log(currentTime.getTime());
                    var timeTweet = array[i].val().TimeOfTweet;
                    var dateStringISO = timeTweet.replace(/([+\-]\d\d)(\d\d)$/, "$1:$2");
                    var timestamp = new Date(dateStringISO).getTime();
                    var hours = Math.abs(currentTime.getTime() - timestamp) / 3600000;
                    console.log(hours);
                    
                    if(hours > 24){
                        var Overdue = "Yes";
                        overdueTasks++;
                        var userRef = new Firebase(FIRE_BASE_URL+USERS_TABLE+uid);
                        userRef.once('value', function(data) {
                                console.log("Takin away task");
                            var trustLevel = data.val().trustLevel;
                            trustLevel--; 

                              $("#trustLevel").html(trustLevel);
                            userRef.update({"trustLevel":trustLevel},function(data){});
                            });
                        overdueTrue(array[i].key(),function(data){});


                    }else{
                        var Overdue = "No"
                    }
                }
                    else
                    overdueTasks++;
                    $("#row13").append('<tr i align=center><td class=taskId style="display: none;">'+array[i].key()+'</td><td>'+array[i].val().TaskType+'</td><td>'+array[i].val().Location+'</td><td>'+array[i].val().OriginalTweet+'</td><td>'+array[i].val().TimeOfTweet+'</td><td>'+array[i].val().Overdue+'</td></tr>');
                }
                console.log("Numberof pending");
                console.log(pendingTasks);
        $("#pendingTasks").html(pendingTasks);
        $("#overdueTasks").html(overdueTasks);

                $('#row13').children('tr').click(function(){
                    console.log(this);
                    $("#progressModal").modal('show');
                    currentid = $(this).find('.taskId').text();
                    console.log("Current ID: "+currentid);
                });
            });

            uid = getId(function(array){});
            getUser(uid,function(data){
                trustLevel = data[0].trustLevel;
                $("#trustLevel").html(trustLevel);
            });
             getCompletedTasks(uid, function(array){
                console.log("Printing data object");
                console.log(array);
                console.log("my completed Tasks");
                for(var i =0;i<(array.length);i++)
                {
                    console.log(array[i]);
                    completedTasks++;

                    $("#row14").append('<tr i align=center><td class=taskId style="display:none">'+array[i].key()+'</td><td>'+array[i].val().TaskType+'</td><td>'+array[i].val().Location+'</td><td>'+array[i].val().OriginalTweet+'</td><td>'+array[i].val().TimeOfTweet+'</td><td>'+"No"+'</td></tr>');
                }
                $("#completedTasks").html(completedTasks);

            });
             console.log("Number of pending");

             
        });
   </script>
</body>

</html>